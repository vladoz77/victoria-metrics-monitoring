vmselect:
  enabled: true
  replicaCount: 2
  name: vmselect
  fullnameOverride: vmselect
  extraArgs:
    replicationFactor: 3
    dedup.minScrapeInterval: 10s
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8481"
  horizontalPodAutoscaler:
    enabled: true
    maxReplicas: 5
    minReplicas: 2
    metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
  # affinity:
  #   podAntiAffinity:  
  #     requiredDuringSchedulingIgnoredDuringExecution:
  #     - labelSelector:
  #         matchExpressions:
  #         - key: app
  #           operator: In
  #           values: [vmselect]
  #       topologyKey: kubernetes.io/hostname
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi

vminsert:
  enabled: true
  name: vminsert
  fullnameOverride: vminsert
  replicaCount: 2
  extraArgs:
    replicationFactor: 3
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8480"
  horizontalPodAutoscaler:
    enabled: true
    maxReplicas: 5
    minReplicas: 2
    metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70 
  # affinity:
  #   podAntiAffinity:  
  #     requiredDuringSchedulingIgnoredDuringExecution:
  #     - labelSelector:
  #         matchExpressions:
  #         - key: app
  #           operator: In
  #           values: [vminsert]
  #       topologyKey: kubernetes.io/hostname
  resources:
    requests:
      cpu: 1000m
      memory: 128Mi
    limits:
      cpu: 200m
      memory: 256Mi
  

vmstorage:
  enabled: true
  name: vmstorage
  replicaCount: 3
  fullnameOverride: vmstorage
  extraArgs:
    retentionPeriod: 30d
  podAnnotations:
    prometheus.io/scrape: "true"
    prometheus.io/port: "8482"
  affinity:
    podAntiAffinity:  
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app
            operator: In
            values: [vmstorage]
        topologyKey: kubernetes.io/hostname
  persistentVolume:
    enabled: true
    storageClass: longhorn-db
    mountPath: /storage
    size: 8Gi
  resources:
    requests:
      cpu: 100m
      memory: 500M
    limits:
      cpu: 200m
      memory: 1000M
  
